{
    "openapi": "3.0.1",
    "info": {
        "title": "NF Portal Agent API",
        "description": "API for the NF Data Portal chatbot assistant to search Synapse tables and provide portal navigation",
        "version": "v1"
    },
    "paths": {
        "/portal/v1/synapse/table/query": {
            "post": {
                "tags": ["PortalAgent"],
                "description": "Search and query Synapse tables relevant to the NF Data Portal. Supports filtering, column selection, and pagination to find datasets, publications, studies, tools, people, and other resources.",
                "operationId": "post_portal_v1_synapse_table_query",
                "parameters": [],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/org.sagebionetworks.portal.TableQueryRequest"
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "200": {
                        "description": "Query results from the Synapse table",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/org.sagebionetworks.portal.TableQueryResponse"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/portal/v1/navigation/url": {
            "post": {
                "tags": ["PortalAgent"],
                "description": "Generate properly formatted URLs for NF Data Portal pages, Synapse entities, and external resources. Use this to provide users with direct links to relevant pages.",
                "operationId": "post_portal_v1_navigation_url",
                "parameters": [],
                "requestBody": {
                    "content": {
                        "application/json": {
                            "schema": {
                                "$ref": "#/components/schemas/org.sagebionetworks.portal.NavigationRequest"
                            }
                        }
                    },
                    "required": true
                },
                "responses": {
                    "200": {
                        "description": "Formatted URL for the requested resource",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "$ref": "#/components/schemas/org.sagebionetworks.portal.NavigationResponse"
                                }
                            }
                        }
                    }
                }
            }
        }
    },
    "components": {
        "schemas": {
            "org.sagebionetworks.portal.TableQueryRequest": {
                "type": "object",
                "properties": {
                    "tableId": {
                        "type": "string",
                        "description": "The Synapse ID of the table to query (e.g., 'syn50913342' for Datasets). Common tables: syn50913342 (Datasets), syn16857542 (Publications), syn52694652 (Studies), syn51730943 (Tools), syn23564971 (People), syn52702673 (Files), syn51735464 (Observations), syn51750823 (Mutations)."
                    },
                    "columns": {
                        "type": "array",
                        "items": {
                            "type": "string"
                        },
                        "description": "Optional. Specific column names to retrieve. If omitted, all columns are returned. Use this to limit the response to only relevant fields."
                    },
                    "filters": {
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/org.sagebionetworks.portal.TableFilter"
                        },
                        "description": "Optional. Array of filter conditions to narrow down results. Multiple filters are combined with AND logic."
                    },
                    "limit": {
                        "type": "integer",
                        "description": "Optional. Maximum number of rows to return. Default is 25. Use smaller values for quick searches, larger for comprehensive results.",
                        "format": "int32",
                        "default": 25
                    },
                    "offset": {
                        "type": "integer",
                        "description": "Optional. Number of rows to skip before returning results. Use for pagination.",
                        "format": "int32",
                        "default": 0
                    }
                },
                "required": ["tableId"]
            },
            "org.sagebionetworks.portal.TableFilter": {
                "type": "object",
                "properties": {
                    "columnName": {
                        "type": "string",
                        "description": "Name of the column to filter on"
                    },
                    "operator": {
                        "type": "string",
                        "description": "Comparison operator to use",
                        "enum": ["EQUALS", "NOT_EQUALS", "CONTAINS", "NOT_CONTAINS", "GREATER_THAN", "LESS_THAN", "IN", "NOT_IN"]
                    },
                    "value": {
                        "description": "Value(s) to compare against. Can be a string, number, boolean, or array for IN/NOT_IN operators"
                    }
                },
                "required": ["columnName", "operator", "value"]
            },
            "org.sagebionetworks.portal.TableQueryResponse": {
                "type": "object",
                "properties": {
                    "headers": {
                        "type": "array",
                        "items": {
                            "type": "string"
                        },
                        "description": "Column names/headers for the returned data"
                    },
                    "rows": {
                        "type": "array",
                        "items": {
                            "type": "object",
                            "additionalProperties": true
                        },
                        "description": "Array of row objects, each containing key-value pairs for column data"
                    },
                    "totalCount": {
                        "type": "integer",
                        "description": "Total number of rows matching the query (before limit/offset)",
                        "format": "int32"
                    }
                }
            },
            "org.sagebionetworks.portal.NavigationRequest": {
                "type": "object",
                "properties": {
                    "resourceType": {
                        "type": "string",
                        "description": "Type of resource to generate URL for",
                        "enum": ["portal_page", "synapse_entity", "filtered_explore", "external_tool"]
                    },
                    "path": {
                        "type": "string",
                        "description": "For portal_page: path like '/Explore/Datasets', '/About'. For synapse_entity: the synID like 'syn50913342'. For external_tool: tool name like 'cavatica', 'pluto', 'terra'."
                    },
                    "filters": {
                        "type": "object",
                        "additionalProperties": {
                            "type": "string"
                        },
                        "description": "Optional. For filtered_explore: key-value pairs to add as query parameters for pre-filtered views (e.g., {'diseaseFocus': 'Plexiform Neurofibroma', 'dataType': 'geneExpression'})"
                    }
                },
                "required": ["resourceType", "path"]
            },
            "org.sagebionetworks.portal.NavigationResponse": {
                "type": "object",
                "properties": {
                    "url": {
                        "type": "string",
                        "description": "The formatted URL for the requested resource"
                    },
                    "displayText": {
                        "type": "string",
                        "description": "Suggested display text for the link"
                    }
                }
            }
        }
    }
}
